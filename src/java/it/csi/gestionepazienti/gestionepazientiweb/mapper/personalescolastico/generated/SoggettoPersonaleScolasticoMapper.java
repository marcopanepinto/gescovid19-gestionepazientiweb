package it.csi.gestionepazienti.gestionepazientiweb.mapper.personalescolastico.generated;

import it.csi.gestionepazienti.gestionepazientiweb.dto.custom.SoggettoForPersonaleScolastico;
import it.csi.gestionepazienti.gestionepazientiweb.dto.custom.SoggettoForVisura;
import it.csi.gestionepazienti.gestionepazientiweb.dto.personalescolastico.SoggettoPersonaleScolastico;
import java.util.List;
import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Options;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.annotations.Update;
import org.apache.ibatis.type.JdbcType;

public interface SoggettoPersonaleScolasticoMapper {
    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table soggetto_personale_scolastico
     *
     * @mbg.generated
     */
    @Delete({
        "delete from soggetto_personale_scolastico",
        "where id_soggetto = #{idSoggetto,jdbcType=BIGINT}"
    })
    int deleteByPrimaryKey(Long idSoggetto);

    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table soggetto_personale_scolastico
     *
     * @mbg.generated
     */
    @Insert({
        "insert into soggetto_personale_scolastico (codice_fiscale, ",
        "id_asr, cognome, nome, ",
        "data_nascita_str, comune_residenza_istat, ",
        "comune_domicilio_istat, indirizzo_domicilio, ",
        "telefono_recapito, data_nascita, ",
        "asl_residenza, asl_domicilio, ",
        "email, lat, lng, ",
        "id_tipo_soggetto, utente_operazione, ",
        "data_creazione, data_modifica, ",
        "data_cancellazione, id_medico, id_soggetto_fk)",
        "values ( #{codiceFiscale,jdbcType=VARCHAR}, ",
        "#{idAsr,jdbcType=BIGINT}, #{cognome,jdbcType=VARCHAR}, #{nome,jdbcType=VARCHAR}, ",
        "#{dataNascitaStr,jdbcType=VARCHAR}, #{comuneResidenzaIstat,jdbcType=VARCHAR}, ",
        "#{comuneDomicilioIstat,jdbcType=VARCHAR}, #{indirizzoDomicilio,jdbcType=VARCHAR}, ",
        "#{telefonoRecapito,jdbcType=VARCHAR}, #{dataNascita,jdbcType=DATE}, ",
        "#{aslResidenza,jdbcType=VARCHAR}, #{aslDomicilio,jdbcType=VARCHAR}, ",
        "#{email,jdbcType=VARCHAR}, #{lat,jdbcType=NUMERIC}, #{lng,jdbcType=NUMERIC}, ",
        "#{idTipoSoggetto,jdbcType=INTEGER}, #{utenteOperazione,jdbcType=VARCHAR}, ",
        "#{dataCreazione,jdbcType=TIMESTAMP}, #{dataModifica,jdbcType=TIMESTAMP}, ",
        "#{dataCancellazione,jdbcType=TIMESTAMP}, #{idMedico,jdbcType=BIGINT}, #{idSoggettoFk,jdbcType=BIGINT})"
    })
    @Options(useGeneratedKeys = true, keyProperty = "idSoggetto", keyColumn = "id_soggetto")
    int insert(SoggettoPersonaleScolastico record);

    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table soggetto_personale_scolastico
     *
     * @mbg.generated
     */
    @Select({
        "select",
        "id_soggetto, codice_fiscale, id_asr, cognome, nome, data_nascita_str, comune_residenza_istat, ",
        "comune_domicilio_istat, indirizzo_domicilio, telefono_recapito, data_nascita, id_soggetto_fk,",
        "asl_residenza, asl_domicilio, email, lat, lng, id_tipo_soggetto, utente_operazione, ",
        "data_creazione, data_modifica, data_cancellazione, id_medico",
        "from soggetto_personale_scolastico",
        "where id_soggetto = #{idSoggetto,jdbcType=BIGINT}"
    })
    @Results({
        @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT, id=true),
        @Result(column="codice_fiscale", property="codiceFiscale", jdbcType=JdbcType.VARCHAR),
        @Result(column="id_asr", property="idAsr", jdbcType=JdbcType.BIGINT),
        @Result(column="cognome", property="cognome", jdbcType=JdbcType.VARCHAR),
        @Result(column="nome", property="nome", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_nascita_str", property="dataNascitaStr", jdbcType=JdbcType.VARCHAR),
        @Result(column="comune_residenza_istat", property="comuneResidenzaIstat", jdbcType=JdbcType.VARCHAR),
        @Result(column="comune_domicilio_istat", property="comuneDomicilioIstat", jdbcType=JdbcType.VARCHAR),
        @Result(column="indirizzo_domicilio", property="indirizzoDomicilio", jdbcType=JdbcType.VARCHAR),
        @Result(column="telefono_recapito", property="telefonoRecapito", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_nascita", property="dataNascita", jdbcType=JdbcType.DATE),
        @Result(column="asl_residenza", property="aslResidenza", jdbcType=JdbcType.VARCHAR),
        @Result(column="asl_domicilio", property="aslDomicilio", jdbcType=JdbcType.VARCHAR),
        @Result(column="email", property="email", jdbcType=JdbcType.VARCHAR),
        @Result(column="lat", property="lat", jdbcType=JdbcType.NUMERIC),
        @Result(column="lng", property="lng", jdbcType=JdbcType.NUMERIC),
        @Result(column="id_tipo_soggetto", property="idTipoSoggetto", jdbcType=JdbcType.INTEGER),
        @Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
        @Result(column="utente_operazione", property="utenteOperazione", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_creazione", property="dataCreazione", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="data_modifica", property="dataModifica", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="data_cancellazione", property="dataCancellazione", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="id_medico", property="idMedico", jdbcType=JdbcType.BIGINT)
    })
    SoggettoPersonaleScolastico selectByPrimaryKey(Long idSoggetto);

    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table soggetto_personale_scolastico
     *
     * @mbg.generated
     */
    @Select({
        "select",
        "id_soggetto, codice_fiscale, id_asr, cognome, nome, data_nascita_str, comune_residenza_istat, ",
        "comune_domicilio_istat, indirizzo_domicilio, telefono_recapito, data_nascita, ",
        "asl_residenza, asl_domicilio, email, lat, lng, id_tipo_soggetto, id_soggetto_fk, utente_operazione, ",
        "data_creazione, data_modifica, data_cancellazione, id_medico",
        "from soggetto_personale_scolastico"
    })
    @Results({
        @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT, id=true),
        @Result(column="codice_fiscale", property="codiceFiscale", jdbcType=JdbcType.VARCHAR),
        @Result(column="id_asr", property="idAsr", jdbcType=JdbcType.BIGINT),
        @Result(column="cognome", property="cognome", jdbcType=JdbcType.VARCHAR),
        @Result(column="nome", property="nome", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_nascita_str", property="dataNascitaStr", jdbcType=JdbcType.VARCHAR),
        @Result(column="comune_residenza_istat", property="comuneResidenzaIstat", jdbcType=JdbcType.VARCHAR),
        @Result(column="comune_domicilio_istat", property="comuneDomicilioIstat", jdbcType=JdbcType.VARCHAR),
        @Result(column="indirizzo_domicilio", property="indirizzoDomicilio", jdbcType=JdbcType.VARCHAR),
        @Result(column="telefono_recapito", property="telefonoRecapito", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_nascita", property="dataNascita", jdbcType=JdbcType.DATE),
        @Result(column="asl_residenza", property="aslResidenza", jdbcType=JdbcType.VARCHAR),
        @Result(column="asl_domicilio", property="aslDomicilio", jdbcType=JdbcType.VARCHAR),
        @Result(column="email", property="email", jdbcType=JdbcType.VARCHAR),
        @Result(column="lat", property="lat", jdbcType=JdbcType.NUMERIC),
        @Result(column="lng", property="lng", jdbcType=JdbcType.NUMERIC),
        @Result(column="id_tipo_soggetto", property="idTipoSoggetto", jdbcType=JdbcType.INTEGER),
        @Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
        @Result(column="utente_operazione", property="utenteOperazione", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_creazione", property="dataCreazione", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="data_modifica", property="dataModifica", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="data_cancellazione", property="dataCancellazione", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="id_medico", property="idMedico", jdbcType=JdbcType.BIGINT)
    })
    List<SoggettoPersonaleScolastico> selectAll();

    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table soggetto_personale_scolastico
     *
     * @mbg.generated
     */
    @Update({
        "update soggetto_personale_scolastico",
        "set codice_fiscale = #{codiceFiscale,jdbcType=VARCHAR},",
          "id_asr = #{idAsr,jdbcType=BIGINT},",
          "cognome = #{cognome,jdbcType=VARCHAR},",
          "nome = #{nome,jdbcType=VARCHAR},",
          "data_nascita_str = #{dataNascitaStr,jdbcType=VARCHAR},",
          "comune_residenza_istat = #{comuneResidenzaIstat,jdbcType=VARCHAR},",
          "comune_domicilio_istat = #{comuneDomicilioIstat,jdbcType=VARCHAR},",
          "indirizzo_domicilio = #{indirizzoDomicilio,jdbcType=VARCHAR},",
          "telefono_recapito = #{telefonoRecapito,jdbcType=VARCHAR},",
          "data_nascita = #{dataNascita,jdbcType=DATE},",
          "asl_residenza = #{aslResidenza,jdbcType=VARCHAR},",
          "asl_domicilio = #{aslDomicilio,jdbcType=VARCHAR},",
          "email = #{email,jdbcType=VARCHAR},",
          "lat = #{lat,jdbcType=NUMERIC},",
          "lng = #{lng,jdbcType=NUMERIC},",
          "id_tipo_soggetto = #{idTipoSoggetto,jdbcType=INTEGER},",
          "utente_operazione = #{utenteOperazione,jdbcType=VARCHAR},",
          "data_creazione = #{dataCreazione,jdbcType=TIMESTAMP},",
          "data_modifica = #{dataModifica,jdbcType=TIMESTAMP},",
          "data_cancellazione = #{dataCancellazione,jdbcType=TIMESTAMP},",
          "id_soggetto_fk = #{idSoggettoFk,jdbcType=INTEGER},",
          "id_medico = #{idMedico,jdbcType=BIGINT}",
        "where id_soggetto = #{idSoggetto,jdbcType=BIGINT}"
    })
    int updateByPrimaryKey(SoggettoPersonaleScolastico record);
    
    
    @Update({
        "update soggetto_personale_scolastico",
        "set ",
          "telefono_recapito = #{telefonoRecapito,jdbcType=VARCHAR},",
          "data_nascita = #{dataNascita,jdbcType=DATE},",
          "asl_domicilio = #{aslDomicilio,jdbcType=VARCHAR} ",
        "where id_soggetto = #{idSoggetto,jdbcType=BIGINT}"
    })
    int updateByPrimaryKey2(SoggettoForPersonaleScolastico record);
    
    
    
    
    @Select({
        "select",
        "id_soggetto, codice_fiscale, id_asr, cognome, nome, data_nascita_str, comune_residenza_istat, ",
        "comune_domicilio_istat, indirizzo_domicilio, telefono_recapito, data_nascita, id_soggetto_fk,",
        "asl_residenza, asl_domicilio, email, lat, lng, id_tipo_soggetto, utente_operazione, ",
        "data_creazione, data_modifica, data_cancellazione, id_medico",
        "from soggetto_personale_scolastico",
        "where utente_operazione = #{cfUtente,jdbcType=VARCHAR}",
        " or id_medico=#{idMedico,jdbcType=BIGINT} "
    })
    @Results({
        @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT, id=true),
        @Result(column="codice_fiscale", property="codiceFiscale", jdbcType=JdbcType.VARCHAR),
        @Result(column="id_asr", property="idAsr", jdbcType=JdbcType.BIGINT),
        @Result(column="cognome", property="cognome", jdbcType=JdbcType.VARCHAR),
        @Result(column="nome", property="nome", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_nascita_str", property="dataNascitaStr", jdbcType=JdbcType.VARCHAR),
        @Result(column="comune_residenza_istat", property="comuneResidenzaIstat", jdbcType=JdbcType.VARCHAR),
        @Result(column="comune_domicilio_istat", property="comuneDomicilioIstat", jdbcType=JdbcType.VARCHAR),
        @Result(column="indirizzo_domicilio", property="indirizzoDomicilio", jdbcType=JdbcType.VARCHAR),
        @Result(column="telefono_recapito", property="telefonoRecapito", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_nascita", property="dataNascita", jdbcType=JdbcType.DATE),
        @Result(column="asl_residenza", property="aslResidenza", jdbcType=JdbcType.VARCHAR),
        @Result(column="asl_domicilio", property="aslDomicilio", jdbcType=JdbcType.VARCHAR),
        @Result(column="email", property="email", jdbcType=JdbcType.VARCHAR),
        @Result(column="lat", property="lat", jdbcType=JdbcType.NUMERIC),
        @Result(column="lng", property="lng", jdbcType=JdbcType.NUMERIC),
        @Result(column="id_tipo_soggetto", property="idTipoSoggetto", jdbcType=JdbcType.INTEGER),
        @Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
        @Result(column="utente_operazione", property="utenteOperazione", jdbcType=JdbcType.VARCHAR),
        @Result(column="data_creazione", property="dataCreazione", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="data_modifica", property="dataModifica", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="data_cancellazione", property="dataCancellazione", jdbcType=JdbcType.TIMESTAMP),
        @Result(column="id_medico", property="idMedico", jdbcType=JdbcType.BIGINT)
    })
    SoggettoPersonaleScolastico selectByIdMedicoOrUtenteOperazione(Long idMedico, String cfUtente);

    
    
    
    
    @Select(
        	{
        		" select   ",
        		" s.id_soggetto, s.codice_fiscale, s.id_asr, s.cognome,  ",
        		" s.nome, s.comune_residenza_istat, s.comune_domicilio_istat, s.indirizzo_domicilio, s.telefono_recapito,  ",
        		" s.data_nascita, s.asl_residenza, s.asl_domicilio, s.id_tipo_soggetto, s.email, s.id_soggetto_fk,",
        		" ts.id_tipo_soggetto , ts.desc_tipo_soggetto ,",
        		" m2.id_medico, m2.cf_medico, m2.codice_reg, m2.cognome medico_cognome , m2.nome medico_nome,",
        		" dtrd.value_code , dtrd.effectivetime_value ",
        		" from",
        		" soggetto_personale_scolastico s",
        		" left join d_tipo_soggetto ts on  s.id_tipo_soggetto = ts.id_tipo_soggetto",
        		" left join dmarefcovid_t_referto dtr on (dtr.codfisc = s.codice_fiscale and dtr.cod_tipo_richiesta = '05')",
        		" left join dmarefcovid_t_referto_det dtrd on dtr.id_messaggio  = dtrd.id_messaggio",
        		" left join medico m2 on m2.id_medico = s.id_medico",
        		" where",
        		" ( s.id_medico = #{idMedico,jdbcType=BIGINT}",
        		" or s.utente_operazione = #{cfUtente,jdbcType=VARCHAR}",
        		" or s.id_medico in (",
        		" select",
        		" y.id_medico_delegante",
        		" from",
        		" r_medico_medico y",
        		" where",
        		" y.id_medico_delegato = #{idMedico,jdbcType=BIGINT}",
        		" and y.data_cancellazione is null",
        		" and now() between y.validita_inizio and coalesce(y.validita_fine, to_timestamp('01/01/2999', 'dd/mm/yyyy'))) )"
        })
        @Results({
            @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT),
            @Result(column = "codice_fiscale", property = "codiceFiscale", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_asr", property = "idAsr", jdbcType = JdbcType.BIGINT),
    		@Result(column = "cognome", property = "cognome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "nome", property = "nome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_residenza_istat", property = "comuneResidenzaIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_domicilio_istat", property = "comuneDomicilioIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "indirizzo_domicilio", property = "indirizzoDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "telefono_recapito", property = "telefonoRecapito", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "data_nascita", property = "dataNascita", jdbcType = JdbcType.DATE),
    		@Result(column = "asl_residenza", property = "aslResidenza", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "asl_domicilio", property = "aslDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "email", property = "email", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_tipo_soggetto", property = "idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
    		
    		@Result(column = "id_tipo_soggetto", property = "tipoSoggetto.idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "desc_tipo_soggetto", property = "tipoSoggetto.descTipoSoggetto", jdbcType = JdbcType.VARCHAR),

			@Result(column = "id_medico", property = "medico.idMedico", jdbcType = JdbcType.BIGINT),
			@Result(column = "cf_medico", property = "medico.cfMedico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "codice_reg", property = "medico.codiceReg", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_cognome", property = "medico.cognome", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_nome", property = "medico.nome", jdbcType = JdbcType.VARCHAR),
			
			@Result(column = "value_code", property = "esitoSierologico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "effectivetime_value", property = "dataTestSierologico", jdbcType = JdbcType.DATE)
            
        })
		List<SoggettoForPersonaleScolastico> selectSoggettiPersonaleScolasticoForVisuraMmgByMedico(@Param("idMedico") Long idMedico, @Param("cfUtente") String cfUtente);

    
    
    @Select(
        	{
        		" select s.id_soggetto,",
        		" s.codice_fiscale,",
        		" s.id_asr,",
        		" s.cognome,",
        		" s.nome,",
        		" s.comune_residenza_istat,",
        		" s.comune_domicilio_istat,",
        		" s.indirizzo_domicilio,",
        		" s.telefono_recapito,",
        		" s.data_nascita,",
        		" s.asl_residenza,",
        		" s.asl_domicilio,",
        		" s.id_tipo_soggetto,",
        		" s.email,",
        		" s.id_soggetto_fk,",
        		" ts.id_tipo_soggetto,",
        		" ts.desc_tipo_soggetto,",
        		" m2.id_medico,",
        		" m2.cf_medico,",
        		" m2.codice_reg,",
        		" m2.cognome medico_cognome,",
        		" m2.nome medico_nome,",
        		" dtrd.value_code,",
        		" dtrd.effectivetime_value from (",
        		" with allenti as (",
        		" select distinct a.*",
        		" ,c.id_ente",
        		" from soggetto_personale_scolastico a, utenti b",
        		" , r_utente_ente c",
        		" where b.cf_utente=a.utente_operazione",
        		" and b.cf_utente=c.cf_utente",
        		" and a.data_cancellazione is null",
        		" union",
//        		" --medico",
        		" select distinct a.* , d.id_ente",
        		" from soggetto_personale_scolastico a, medico b",
        		" , r_utente_struttura c",
        		" , struttura d",
        		" , ente e",
        		" where b.cf_medico=a.utente_operazione",
        		" and c.cf_utente=b.cf_medico",
        		" and d.id_struttura=c.id_struttura",
        		" and e.id_ente=d.id_ente",
        		" and a.data_cancellazione is null",
        		" union",
//        		" --medico usca",
        		" select distinct a.* , d.id_ente",
        		" from soggetto_personale_scolastico a, medico_usca b",
        		" , r_utente_struttura c",
        		" , struttura d",
        		" , ente e",
        		" where b.cf_medico=a.utente_operazione",
        		" and c.cf_utente=b.cf_medico",
        		" and d.id_struttura=c.id_struttura",
        		" and e.id_ente=d.id_ente",
        		" and a.data_cancellazione is null",
        		" )",
        		" , myenti AS",
        		" (",
        		" select distinct c.id_ente",
        		" from utenti b",
        		" , r_utente_ente c",
        		" where b.cf_utente=c.cf_utente",
        		" and b.cf_utente=#{cfUtente,jdbcType=VARCHAR}",
        		" union",
//        		" --medico",
        		" select distinct d.id_ente",
        		" from medico b",
        		" , r_utente_struttura c",
        		" , struttura d",
        		" , ente e",
        		" where c.cf_utente=b.cf_medico",
        		" and d.id_struttura=c.id_struttura",
        		" and e.id_ente=d.id_ente",
        		" and b.cf_medico=#{cfUtente,jdbcType=VARCHAR}",
        		" union",
        		//" --medico usca",
        		" select distinct d.id_ente",
        		" from medico_usca b",
        		" , r_utente_struttura c",
        		" , struttura d",
        		" , ente e",
        		" where c.cf_utente=b.cf_medico",
        		" and d.id_struttura=c.id_struttura",
        		" and e.id_ente=d.id_ente",
        		" and b.cf_medico=#{cfUtente,jdbcType=VARCHAR})",
        		" select distinct",
        		" a.id_soggetto,",
        		" a.codice_fiscale,",
        		" a.id_asr,",
        		" a.cognome,",
        		" a.nome,",
        		" a.data_nascita_str,",
        		" a.comune_residenza_istat,",
        		" a.comune_domicilio_istat,",
        		" a.indirizzo_domicilio,",
        		" a.telefono_recapito,",
        		" a.data_nascita,",
        		" a.asl_residenza,",
        		" a.asl_domicilio,",
        		" a.email,",
        		" a.id_soggetto_fk,",
        		" a.lat,",
        		" a.lng,",
        		" a.id_tipo_soggetto,",
        		" a.utente_operazione,",
        		" a.data_creazione,",
        		" a.data_modifica,",
        		" a.data_cancellazione,",
        		" a.id_medico",
        		" from allenti a, myenti b where a.id_ente=b.id_ente",
        		" ) as s",
        		" left join d_tipo_soggetto ts on s.id_tipo_soggetto = ts.id_tipo_soggetto",
        		" left join dmarefcovid_t_referto dtr on (dtr.codfisc = s.codice_fiscale and dtr.cod_tipo_richiesta = '05'",
        		" )",
        		" left join dmarefcovid_t_referto_det dtrd on dtr.id_messaggio = dtrd.id_messaggio",
        		" left join medico m2 on m2.id_medico = s.id_medico"
        })
        @Results({
            @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT),
            @Result(column = "codice_fiscale", property = "codiceFiscale", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_asr", property = "idAsr", jdbcType = JdbcType.BIGINT),
    		@Result(column = "cognome", property = "cognome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "nome", property = "nome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_residenza_istat", property = "comuneResidenzaIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_domicilio_istat", property = "comuneDomicilioIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "indirizzo_domicilio", property = "indirizzoDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "telefono_recapito", property = "telefonoRecapito", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "data_nascita", property = "dataNascita", jdbcType = JdbcType.DATE),
    		@Result(column = "asl_residenza", property = "aslResidenza", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "asl_domicilio", property = "aslDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "email", property = "email", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_tipo_soggetto", property = "idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
    		
    		@Result(column = "id_tipo_soggetto", property = "tipoSoggetto.idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "desc_tipo_soggetto", property = "tipoSoggetto.descTipoSoggetto", jdbcType = JdbcType.VARCHAR),

			@Result(column = "id_medico", property = "medico.idMedico", jdbcType = JdbcType.BIGINT),
			@Result(column = "cf_medico", property = "medico.cfMedico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "codice_reg", property = "medico.codiceReg", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_cognome", property = "medico.cognome", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_nome", property = "medico.nome", jdbcType = JdbcType.VARCHAR),
			
			@Result(column = "value_code", property = "esitoSierologico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "effectivetime_value", property = "dataTestSierologico", jdbcType = JdbcType.DATE)
            
        })
		List<SoggettoForPersonaleScolastico> selectSoggettiPersonaleScolasticoForVisuraMmgForEnte(@Param("cfUtente") String cfUtente);
    	
    
    

    @Select(
        	{
        		" select   ",
        		" s.id_soggetto, s.codice_fiscale, s.id_asr, s.cognome,  ",
        		" s.nome, s.comune_residenza_istat, s.comune_domicilio_istat, s.indirizzo_domicilio, s.telefono_recapito,  ",
        		" s.data_nascita, s.asl_residenza, s.asl_domicilio, s.id_tipo_soggetto, s.email, s.id_soggetto_fk, ",
        		" ts.id_tipo_soggetto , ts.desc_tipo_soggetto ,",
        		" m2.id_medico, m2.cf_medico, m2.codice_reg,m2.cognome medico_cognome , m2.nome medico_nome,",
        		" dtrd.value_code , dtrd.data_creazione ",
        		" from",
        		" soggetto_personale_scolastico s",
        		" left join d_tipo_soggetto ts on  s.id_tipo_soggetto = ts.id_tipo_soggetto",
        		" left join dmarefcovid_t_referto dtr on (dtr.codfisc = s.codice_fiscale and dtr.cod_tipo_richiesta = '05')",
        		" left join dmarefcovid_t_referto_det dtrd on dtr.id_messaggio  = dtrd.id_messaggio",
        		" left join medico m2 on m2.id_medico = s.id_medico",
        		" where",
        		" s.id_soggetto = #{idSoggetto,jdbcType=BIGINT} and",
        		" ( s.id_medico = #{idMedico,jdbcType=BIGINT}",
        		" or s.utente_operazione = #{cfUtente,jdbcType=VARCHAR}",
        		" or s.id_medico in (",
        		" select",
        		" y.id_medico_delegante",
        		" from",
        		" r_medico_medico y",
        		" where",
        		" y.id_medico_delegato = #{idMedico,jdbcType=BIGINT}",
        		" and y.data_cancellazione is null",
        		" and now() between y.validita_inizio and coalesce(y.validita_fine, to_timestamp('01/01/2999', 'dd/mm/yyyy'))) )",
        })
        @Results({
            @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT),
            @Result(column = "codice_fiscale", property = "codiceFiscale", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_asr", property = "idAsr", jdbcType = JdbcType.BIGINT),
    		@Result(column = "cognome", property = "cognome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "nome", property = "nome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_residenza_istat", property = "comuneResidenzaIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_domicilio_istat", property = "comuneDomicilioIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "indirizzo_domicilio", property = "indirizzoDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "telefono_recapito", property = "telefonoRecapito", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "data_nascita", property = "dataNascita", jdbcType = JdbcType.DATE),
    		@Result(column = "asl_residenza", property = "aslResidenza", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "asl_domicilio", property = "aslDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "email", property = "email", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_tipo_soggetto", property = "idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
    		
    		@Result(column = "id_tipo_soggetto", property = "tipoSoggetto.idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "desc_tipo_soggetto", property = "tipoSoggetto.descTipoSoggetto", jdbcType = JdbcType.VARCHAR),

			@Result(column = "id_medico", property = "medico.idMedico", jdbcType = JdbcType.BIGINT),
			@Result(column = "cf_medico", property = "medico.cfMedico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "codice_reg", property = "medico.codiceReg", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_cognome", property = "medico.cognome", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_nome", property = "medico.nome", jdbcType = JdbcType.VARCHAR),
			
			@Result(column = "value_code", property = "esitoSierologico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "data_creazione", property = "dataTestSierologico", jdbcType = JdbcType.DATE)
            
        })
		SoggettoForPersonaleScolastico selectSoggettoPersonaleScolasticoForVisuraMmgByIdSoggetto(@Param("idSoggetto") Long idSoggetto,@Param("idMedico") Long idMedico, @Param("cfUtente") String cfUtente);

    
    @Select(
        	{
        		" select   ",
        		" s.id_soggetto, s.codice_fiscale, s.id_asr, s.cognome,  ",
        		" s.nome, s.comune_residenza_istat, s.comune_domicilio_istat, s.indirizzo_domicilio, s.telefono_recapito,  ",
        		" s.data_nascita, s.asl_residenza, s.asl_domicilio, s.id_tipo_soggetto, s.email, s.id_soggetto_fk, ",
        		" ts.id_tipo_soggetto , ts.desc_tipo_soggetto ,",
        		" m2.id_medico, m2.cf_medico, m2.codice_reg,m2.cognome medico_cognome , m2.nome medico_nome,",
        		" dtrd.value_code , dtrd.data_creazione ",
        		" from",
        		" soggetto_personale_scolastico s",
        		" left join d_tipo_soggetto ts on  s.id_tipo_soggetto = ts.id_tipo_soggetto",
        		" left join dmarefcovid_t_referto dtr on (dtr.codfisc = s.codice_fiscale and dtr.cod_tipo_richiesta = '05')",
        		" left join dmarefcovid_t_referto_det dtrd on dtr.id_messaggio  = dtrd.id_messaggio",
        		" left join medico m2 on m2.id_medico = s.id_medico",
        		" where",
        		" s.id_soggetto = #{idSoggetto,jdbcType=BIGINT} "
        })
        @Results({
            @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT),
            @Result(column = "codice_fiscale", property = "codiceFiscale", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_asr", property = "idAsr", jdbcType = JdbcType.BIGINT),
    		@Result(column = "cognome", property = "cognome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "nome", property = "nome", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_residenza_istat", property = "comuneResidenzaIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "comune_domicilio_istat", property = "comuneDomicilioIstat", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "indirizzo_domicilio", property = "indirizzoDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "telefono_recapito", property = "telefonoRecapito", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "data_nascita", property = "dataNascita", jdbcType = JdbcType.DATE),
    		@Result(column = "asl_residenza", property = "aslResidenza", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "asl_domicilio", property = "aslDomicilio", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "email", property = "email", jdbcType = JdbcType.VARCHAR),
    		@Result(column = "id_tipo_soggetto", property = "idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
    		
    		@Result(column = "id_tipo_soggetto", property = "tipoSoggetto.idTipoSoggetto", jdbcType = JdbcType.BIGINT),
    		@Result(column = "desc_tipo_soggetto", property = "tipoSoggetto.descTipoSoggetto", jdbcType = JdbcType.VARCHAR),

			@Result(column = "id_medico", property = "medico.idMedico", jdbcType = JdbcType.BIGINT),
			@Result(column = "cf_medico", property = "medico.cfMedico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "codice_reg", property = "medico.codiceReg", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_cognome", property = "medico.cognome", jdbcType = JdbcType.VARCHAR),
			@Result(column = "medico_nome", property = "medico.nome", jdbcType = JdbcType.VARCHAR),
			
			@Result(column = "value_code", property = "esitoSierologico", jdbcType = JdbcType.VARCHAR),
			@Result(column = "data_creazione", property = "dataTestSierologico", jdbcType = JdbcType.DATE)
            
        })
		SoggettoForPersonaleScolastico selectSoggettoPersonaleScolasticoByIdSoggetto(@Param("idSoggetto") Long idSoggetto);
    
    
	    @Select({
	        "select",
	        "id_soggetto, codice_fiscale, id_asr, cognome, nome, data_nascita_str, comune_residenza_istat, ",
	        "comune_domicilio_istat, indirizzo_domicilio, telefono_recapito, data_nascita, id_soggetto_fk,",
	        "asl_residenza, asl_domicilio, email, lat, lng, id_tipo_soggetto, utente_operazione, ",
	        "data_creazione, data_modifica, data_cancellazione, id_medico",
	        "from soggetto_personale_scolastico",
	        "where codice_fiscale = #{codiceFiscale,jdbcType=VARCHAR}"
	    })
	    @Results({
	        @Result(column="id_soggetto", property="idSoggetto", jdbcType=JdbcType.BIGINT, id=true),
	        @Result(column="codice_fiscale", property="codiceFiscale", jdbcType=JdbcType.VARCHAR),
	        @Result(column="id_asr", property="idAsr", jdbcType=JdbcType.BIGINT),
	        @Result(column="cognome", property="cognome", jdbcType=JdbcType.VARCHAR),
	        @Result(column="nome", property="nome", jdbcType=JdbcType.VARCHAR),
	        @Result(column="data_nascita_str", property="dataNascitaStr", jdbcType=JdbcType.VARCHAR),
	        @Result(column="comune_residenza_istat", property="comuneResidenzaIstat", jdbcType=JdbcType.VARCHAR),
	        @Result(column="comune_domicilio_istat", property="comuneDomicilioIstat", jdbcType=JdbcType.VARCHAR),
	        @Result(column="indirizzo_domicilio", property="indirizzoDomicilio", jdbcType=JdbcType.VARCHAR),
	        @Result(column="telefono_recapito", property="telefonoRecapito", jdbcType=JdbcType.VARCHAR),
	        @Result(column="data_nascita", property="dataNascita", jdbcType=JdbcType.DATE),
	        @Result(column="asl_residenza", property="aslResidenza", jdbcType=JdbcType.VARCHAR),
	        @Result(column="asl_domicilio", property="aslDomicilio", jdbcType=JdbcType.VARCHAR),
	        @Result(column="email", property="email", jdbcType=JdbcType.VARCHAR),
	        @Result(column="lat", property="lat", jdbcType=JdbcType.NUMERIC),
	        @Result(column="lng", property="lng", jdbcType=JdbcType.NUMERIC),
	        @Result(column="id_tipo_soggetto", property="idTipoSoggetto", jdbcType=JdbcType.INTEGER),
	        @Result(column = "id_soggetto_fk", property = "idSoggettoFk", jdbcType = JdbcType.BIGINT),
	        @Result(column="utente_operazione", property="utenteOperazione", jdbcType=JdbcType.VARCHAR),
	        @Result(column="data_creazione", property="dataCreazione", jdbcType=JdbcType.TIMESTAMP),
	        @Result(column="data_modifica", property="dataModifica", jdbcType=JdbcType.TIMESTAMP),
	        @Result(column="data_cancellazione", property="dataCancellazione", jdbcType=JdbcType.TIMESTAMP),
	        @Result(column="id_medico", property="idMedico", jdbcType=JdbcType.BIGINT)
	    })
	    SoggettoPersonaleScolastico selectByCodiceFiscale(@Param("codiceFiscale") String codiceFiscale);
}